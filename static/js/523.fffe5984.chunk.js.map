{"version":3,"file":"static/js/523.fffe5984.chunk.js","mappings":"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","sources":["lib/near/sender-wallet.ts","components/agreement/agreement.tsx","components/proceed-button/proceed-button.tsx","ui/input/input.tsx","ui/icon/icon.tsx","components/currency-input/currency-select/currency-select.tsx","components/currency-input/currency-input.tsx","ui/widget-container/widget-container.tsx","components/expiry-timer/expiry-timer.tsx","components/pay-widget/pay-widget.tsx","helpers/main.ts","pages/payment-page/model.ts","pages/payment-page/payment-page.tsx","pages/payment-page/index.ts"],"sourcesContent":["import { DEFAULT_FUNCTION_CALL_GAS } from \"near-api-js\";\nimport { ICurrency } from \"lib/api/currencies\";\nimport { TPayment } from \"lib/api\";\nimport { toast } from \"lib/toast\";\n\nconst useSenderWallet = () => {\n  // @ts-ignore\n  const wallet = window.near;\n\n  const ftTransfer = async (amount: string, contractName: string, receiver: string) =>\n    wallet.signAndSendTransaction({\n      receiverId: contractName,\n      actions: [\n        {\n          methodName: \"ft_transfer\",\n          args: {\n            receiver_id: receiver,\n            amount: amount,\n          },\n          gas: DEFAULT_FUNCTION_CALL_GAS,\n          deposit: 1,\n        },\n      ],\n    });\n\n  const assertResult = (result: any, payment: TPayment) => {\n    if (result.response.error) {\n      toast(result.response.error.kind?.ExecutionError ?? \"Contract error\");\n      return;\n    }\n\n    const redirect = `${window.location.origin}/payment/${payment.paymentId}/pending`;\n    window.location.href = redirect;\n  };\n\n  return {\n    isAvailable: wallet?.isSender ?? false,\n    pay: async (currency: ICurrency, payment: TPayment) => {\n      if (wallet == null || wallet.isSender === false) return;\n\n      if (wallet.isSignedIn() === false) {\n        // SenderWallet does not care what the contract id will be\n        await wallet.requestSignIn({ contractId: \"usn\" });\n      }\n\n      switch (currency.ticker) {\n        case \"NEAR\": {\n          const result = await wallet.sendMoney({ receiverId: payment.address, amount: payment.amount });\n          assertResult(result, payment);\n          return;\n        }\n\n        case \"USN\": {\n          const usnUnits = (+payment.displayAmountUsd * 1e18).toString();\n          const result = await ftTransfer(usnUnits, \"usn\", payment.address);\n          assertResult(result, payment);\n          return;\n        }\n\n        default:\n          toast(\"This ticker is not supported yet\");\n          return;\n      }\n    },\n  };\n};\n\nexport default useSenderWallet;\n","import block from \"bem-cn\";\nimport \"./agreement.scss\";\n\nconst b = block(\"pay-with-near-agreement\");\n\ntype Props = {\n  className?: string;\n};\n\nexport const Agreement: React.FC<Props> = (props) => {\n  const { className } = props;\n\n  return (\n    <div className={b.mix(className)}>\n      By continuing, you agree to this{\" \"}\n      <a\n        href=\"https://nearpay.co/privacy_policy\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        privacy policy\n      </a>{\" \"}\n      and{\" \"}\n      <a\n        href=\"https://nearpay.co/terms_of_use\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        terms of service\n      </a>\n    </div>\n  );\n};\n","import classNames from \"classnames\";\nimport React, {\n  AnchorHTMLAttributes,\n  ButtonHTMLAttributes,\n  forwardRef,\n} from \"react\";\nimport \"./proceed-button.scss\";\n\ninterface IProceedButtonComponentProps\n  extends ButtonHTMLAttributes<HTMLButtonElement> {\n  disabled?: boolean;\n  loading?: boolean;\n  loadingText?: string | React.ReactNode;\n  withArrow?: boolean;\n  icon?: React.ReactNode;\n}\ninterface IProceedLinkComponentProps\n  extends AnchorHTMLAttributes<HTMLAnchorElement> {\n  disabled?: boolean;\n  loading?: boolean;\n  loadingText?: string | React.ReactNode;\n  withArrow?: boolean;\n}\n\nfunction proceedAppearance({\n  disabled,\n  loading,\n}: {\n  disabled: boolean;\n  loading: boolean;\n}) {\n  const stateClassName = disabled\n    ? \"ProceedButton--disabled\"\n    : loading\n    ? \"ProceedButton--loading\"\n    : \"ProceedButton--active\";\n\n  return stateClassName;\n}\n\nexport const ProceedLink = forwardRef<\n  HTMLAnchorElement,\n  IProceedLinkComponentProps\n>(\n  (\n    {\n      disabled = false,\n      children,\n      loading = false,\n      className,\n      withArrow = true,\n      loadingText,\n      href,\n      ...rest\n    },\n    ref\n  ) => {\n    const stateClassName = proceedAppearance({ disabled, loading });\n    return (\n      <a\n        ref={ref}\n        className={classNames(\"ProceedButton\", stateClassName, className)}\n        href={disabled ? undefined : href}\n        {...rest}\n      >\n        {loading && loadingText ? (\n          <>\n            <span></span>\n            <span>{loadingText}</span>\n            <span></span>\n          </>\n        ) : (\n          <>\n            <span></span>\n            <span>{children}</span>\n            <span></span>\n          </>\n        )}\n      </a>\n    );\n  }\n);\n\nexport const ProceedButton = forwardRef<\n  HTMLButtonElement,\n  IProceedButtonComponentProps\n>(\n  (\n    {\n      disabled = false,\n      children,\n      loading = false,\n      className,\n      withArrow = true,\n      loadingText,\n      icon,\n      ...rest\n    },\n    ref\n  ) => {\n    const stateClassName = proceedAppearance({ disabled, loading });\n\n    return (\n      <button\n        ref={ref}\n        className={classNames(\"ProceedButton\", stateClassName, className)}\n        disabled={disabled}\n        {...rest}\n      >\n        {loading && loadingText ? (\n          <>\n            <span></span>\n            <span>{loadingText}</span>\n            <span></span>\n          </>\n        ) : (\n          <>\n            <span></span>\n            <span>{children}</span>\n            <span></span>\n          </>\n        )}\n        {icon && <div className={\"ProceedButton__icon\"}>{icon}</div>}\n      </button>\n    );\n  }\n);\n","import classNames from \"classnames\";\nimport React from \"react\";\n\nimport \"./input.scss\";\n\ninterface IInputComponentProps\n  extends React.LabelHTMLAttributes<HTMLLabelElement> {\n  slotAfterInput?: React.ReactNode;\n  slotAfterLabel?: React.ReactNode;\n  slotRight?: React.ReactNode;\n  label: React.ReactNode;\n  error?: string;\n  size?: \"big\" | \"normal\" | \"small\";\n  textSize?: \"\" | \"small\" | \"normal\" | \"big\";\n}\n\nexport function Input({\n  label,\n  slotAfterInput,\n  slotRight,\n  slotAfterLabel,\n  children,\n  error,\n  size = \"normal\",\n  textSize = \"normal\",\n  className,\n  placeholder,\n  ...rest\n}: IInputComponentProps): JSX.Element {\n  if (slotAfterInput && slotRight) {\n    throw Error(\"Only one of after input slots can be used\");\n  }\n\n  return (\n    <label\n      className={classNames(\"Input\", error ? \"Input--hasError\" : \"\", className)}\n      {...rest}\n    >\n      <div className=\"flex\">\n        <div className=\"flex-grow\">\n          <div className={\"Input__header\"}>\n            <div className={\"Input__label\"}>{label}</div>\n            {slotAfterLabel}\n          </div>\n          <div className={\"Input__wrapper\"}>\n            {typeof children === \"function\"\n              ? children({ inputClass: \"Input__input\" })\n              : children}\n            {slotAfterInput ? (\n              <div className={\"Input__after\"}>{slotAfterInput}</div>\n            ) : null}\n          </div>\n        </div>\n        {slotRight ? (\n          <div className={\"Input__afterCentered\"}>{slotRight}</div>\n        ) : null}\n      </div>\n      {error ? <div className={\"Input__error\"}>{error}</div> : null}\n    </label>\n  );\n}\n","import classNames from \"classnames\";\nimport React, { HTMLAttributes } from \"react\";\n\nimport \"./icon.scss\";\n\nexport type TCreditCardIconName =\n  | \"amex\"\n  | \"card\"\n  | \"mastercard\"\n  | \"unionpay\"\n  | \"visa\";\n\nexport type TCurrencyIconName =\n  | \"currency-btc\"\n  | \"currency-usd\"\n  | \"currency-near\";\n\nexport type TIconName =\n  | \"arrow-up-circle\"\n  | \"info-square\"\n  | \"dropdown-arrow\"\n  | \"arrow-right-square\"\n  | \"near-pay-logo\"\n  | \"spinner\";\n\ninterface ICssTransform {\n  rotate?: string;\n}\n\ninterface IIconComponentProps extends HTMLAttributes<HTMLDivElement> {\n  icon?: TIconName | TCurrencyIconName | TCreditCardIconName;\n  renderIcon?: React.ReactNode;\n  size?: number;\n  transform?: ICssTransform;\n}\n\nfunction buildTransform(transform: ICssTransform): string {\n  if (!transform) return \"\";\n\n  const properties: string[] = [];\n\n  for (const [property, value] of Object.entries(transform)) {\n    properties.push(`${property}(${value})`);\n  }\n\n  return properties.join(\",\");\n}\n\nexport function Icon({\n  icon = \"info-square\",\n  className,\n  transform,\n  size,\n  children,\n  ...rest\n}: IIconComponentProps): JSX.Element {\n  // const IconComponent = icons[icon];\n\n  const transformProp = buildTransform(transform || {});\n\n  return (\n    <i\n      className={classNames(\"pay-with-near-icon\", className)}\n      style={{ transform: transformProp, width: size, height: size }}\n      {...rest}\n    >\n      {children}\n      {/* {children ||\n        (IconComponent && (\n          <Suspense fallback={<span></span>}>\n            <IconComponent />\n          </Suspense>\n        ))} */}\n    </i>\n  );\n}\n","import classNames from \"classnames\";\nimport { ICurrency } from \"lib/api/currencies\";\nimport {HTMLAttributes, useCallback, useState} from \"react\";\nimport { NpDropdownArrowIcon } from \"ui\";\nimport { Icon } from \"ui/icon\";\n\nimport \"./currency-select.scss\";\n\ninterface ICurrencySelectComponentProps extends HTMLAttributes<HTMLDivElement> {\n  currency: ICurrency;\n  disabled: boolean;\n  options?: ICurrency[];\n  onCurrencySelectClick: (currencyName: string) => void;\n}\n\nexport function CurrencySelect({\n  currency,\n  options,\n  className,\n  disabled,\n  onCurrencySelectClick,\n  ...rest\n}: ICurrencySelectComponentProps): JSX.Element {\n    const [isOpen, setOpen] = useState(false);\n\n    const isMobile = () => Boolean(navigator.userAgent.match(/Android/i) ||\n        navigator.userAgent.match(/iPhone/i));\n\n    const toggleOpen = useCallback(\n        () => {\n            setOpen((prev) => !prev);\n        },\n        [],\n    );\n\n    const chooseOption = useCallback(\n        (value: string) => {\n            toggleOpen();\n            onCurrencySelectClick(value);\n        }, [],\n    )\n  return (\n        <div\n          className={classNames(\n            \"CurrencySelect\",\n            disabled ? \"CurrencySelect--disabled\" : \"\",\n            className\n          )}\n          {...rest}\n        >\n            { isMobile()\n                ? <>\n                    <Icon className={\"CurrencySelect__icon\"}>\n                        <img src={currency.logoUrl} alt={currency.viewedTicker} />\n                    </Icon>\n                    <select className={\"CurrencySelect__select\"}\n                            onChange={(event) => onCurrencySelectClick(event.target.value)}\n                    >\n                        {\n                            options?.map(option => (\n                                <option key={option.ticker} value={option.ticker}>{option.ticker}</option>\n                            ))\n                        }\n\n                    </select>\n                </>\n                : <>\n                    <div className={\"CurrencySelect__container\"}>\n                        <button  className={\"CurrencySelect__button\"} onClick={toggleOpen}>\n                            <Icon className={\"CurrencySelect__icon\"}>\n                                <img src={currency.logoUrl} alt={currency.viewedTicker} />\n                            </Icon>\n                            <div className={\"CurrencySelect__text\"}>{currency.ticker}</div>\n                            <Icon size={20} className={\"CurrencySelect__arrow\"}>\n                                <NpDropdownArrowIcon />\n                            </Icon>\n                        </button>\n                        {isOpen && <ul className={\"CurrencySelect__list\"}>\n                            {\n                                options?.map(option => (\n                                    <li key={option.ticker} className={\"CurrencySelect__item\"} onClick={() => chooseOption(option.ticker)}>\n                                        <Icon className={\"CurrencySelect__icon\"}>\n                                            <img src={option.logoUrl} alt={option.ticker} />\n                                        </Icon>\n                                        {option.ticker}\n                                    </li>\n                                ))\n                            }\n                        </ul>}\n                    </div>\n                </>}\n        </div>\n  );\n}\n","import { ICurrency } from 'lib/api/currencies';\nimport React from 'react';\nimport NumberFormat, { NumberFormatValues } from 'react-number-format';\nimport { Input } from 'ui/input';\nimport { CurrencySelect } from './currency-select';\n\ninterface ICurrencyInputComponentProps\n  extends React.HTMLAttributes<HTMLElement> {\n  onValueChange: (values: NumberFormatValues) => void;\n  currency: ICurrency;\n  onCurrencySelectClick: (currencyName: string) => void;\n  renderAfter?: React.ReactNode;\n  value?: string;\n  label: React.ReactNode;\n  error?: string;\n  selectDisabled?: boolean;\n  inputDisabled?: boolean;\n  isLoading?: boolean;\n  currencies?: ICurrency[];\n}\n\nexport function CurrencyInput({\n  onInput,\n  value,\n  label,\n  onValueChange,\n  onCurrencySelectClick,\n  error,\n  selectDisabled,\n  inputDisabled,\n  currency,\n  currencies,\n  isLoading = false,\n  ...rest\n}: ICurrencyInputComponentProps): JSX.Element {\n  const prefix = currency.symbol;\n  // const suffix = currency.symbol ? '' : '' + currency.ticker.toUpperCase();\n\n  return (\n    <Input\n      label={label}\n      error={error}\n      slotAfterInput={\n        <CurrencySelect\n          currency={currency}\n          onCurrencySelectClick={\n            selectDisabled\n              ? () => {}\n              : onCurrencySelectClick\n          }\n          disabled={!!selectDisabled}\n          options={currencies}\n        />\n      }\n      {...rest}\n    >\n      {isLoading ? (\n        <input disabled readOnly/>\n      ) : (\n        <NumberFormat\n          thousandSeparator={false}\n          prefix={prefix}\n          onValueChange={onValueChange}\n          allowLeadingZeros={true}\n          decimalScale={currency.roundOff}\n          onInput={onInput}\n          value={value}\n          placeholder=\"0.00\"\n          readOnly={inputDisabled}\n        />\n      )}\n    </Input>\n  );\n}\n","import './widget-container.scss';\nimport classNames from 'classnames';\nimport React, { HTMLAttributes } from 'react';\n\nexport function WidgetContainer({\n  className,\n  ...rest\n}: HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div className={classNames('WidgetContainer', className)} {...rest}></div>\n  );\n}\n","import \"./expiry-timer.scss\";\n\nimport { block } from \"bem-cn\";\nimport { useEffect, useState } from \"react\";\nimport dayjs from \"dayjs\";\n\nconst b = block(\"pay-with-near-pay-timer\");\n\ninterface Props {\n  expiryAt: string;\n  onExpired: () => void;\n}\nexport const ExpiryTimer: React.FC<Props> = (props) => {\n  const { expiryAt, onExpired } = props;\n  const [timeLeft, setTimeLeft] = useState(getTimeLeft(expiryAt));\n\n  useEffect(() => {\n    if (getTimeLeft(expiryAt) < 0) {\n      onExpired();\n    }\n\n    const timer = setTimeout(() => {\n      setTimeLeft(getTimeLeft(expiryAt));\n    }, 1000);\n\n    return () => clearTimeout(timer);\n  }, [timeLeft, expiryAt, onExpired]);\n\n  if (getTimeLeft(expiryAt) < 0) {\n    return null;\n  }\n\n  return <div className={b()}>{msecToTimeFormat(timeLeft)}</div>;\n};\n\nconst getTimeLeft = (expiryAt: string): number => {\n  const expiryAtDayjs = dayjs(expiryAt);\n  const curDayjs = dayjs.utc();\n\n  const millisecondLeft = expiryAtDayjs.diff(curDayjs);\n\n  return millisecondLeft;\n};\n\nconst msecToTimeFormat = (ms: number): string => {\n  const minutes = Math.floor(ms / (60 * 1000));\n  const minutesMs = ms % (60 * 1000);\n  const seconds = Math.floor(minutesMs / 1000);\n\n  return `${minutes}:${seconds > 9 ? seconds : `0${seconds}`}`;\n};\n","import \"./pay-widget.scss\";\n\nimport { block } from \"bem-cn\";\nimport { NpLogoIcon } from \"ui\";\nimport { ProceedButton } from \"components/proceed-button\";\nimport { ICurrency } from \"lib/api/currencies\";\nimport { CurrencyInput } from \"components/currency-input\";\nimport classNames from \"classnames\";\nimport { WidgetContainer } from \"ui/widget-container/widget-container\";\nimport { TPayment } from \"lib/api\";\nimport { ExpiryTimer } from \"components/expiry-timer\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport { useCallback, useState } from \"react\";\nimport { snakeToCamel } from \"../../helpers/main\";\n\nconst b = block(\"pay-with-near-pay-widget\");\nconst bDescription = block(\"pay-with-near-pay-widget-description\");\n\ninterface Props {\n  payment: TPayment;\n  defaultCurrency: ICurrency;\n  hasSenderWallet: boolean;\n  onPay: (currency: ICurrency) => void;\n  onSenderWallet: (currency: ICurrency) => void;\n  onExpired: () => void;\n  currencies?: ICurrency[];\n}\nexport const PayWidget: React.FC<Props> = (props) => {\n  const { payment, defaultCurrency, onPay, onSenderWallet, onExpired, currencies, hasSenderWallet } = props;\n  const [currency, setCurrency] = useState<ICurrency>();\n\n  const changeCurrency = useCallback(\n    (currency: string) => {\n      const currentCurrency = currencies?.find((item) => item.ticker === currency);\n      setCurrency(currentCurrency);\n    },\n    [currencies]\n  );\n\n  return (\n    <WidgetContainer className={b()}>\n      <div className={b(\"title\")}>{payment.name}</div>\n      <div className={b(\"description\")}>{payment.description}</div>\n      <div className={bDescription()}>\n        <div>\n          <div className={bDescription(\"label\")}>Payment: </div>\n          <div>{payment.paymentId}</div>\n        </div>\n        <div>\n          <div className={bDescription(\"label\")}>Recipient: </div>\n          <div className={bDescription(\"address\")}>{payment.address}</div>\n        </div>\n      </div>\n      <ExpiryTimer expiryAt={payment.expiryAt} onExpired={onExpired} />\n      <CurrencyInput\n        label={\"Amount to Pay\"}\n        value={payment[snakeToCamel(currency?.parameter || defaultCurrency?.parameter) as keyof TPayment]}\n        currency={currency || defaultCurrency}\n        onValueChange={() => {}}\n        onCurrencySelectClick={changeCurrency}\n        selectDisabled={false}\n        currencies={currencies}\n        className=\"mb-4\"\n      />\n\n      <ProceedButton onClick={() => onPay(currency || defaultCurrency)}>Pay with NEAR wallet</ProceedButton>\n\n      {hasSenderWallet && (\n        <ProceedButton onClick={() => onSenderWallet(currency || defaultCurrency)}>\n          Pay with Sender Wallet\n        </ProceedButton>\n      )}\n\n      <div className={b(\"or\")}>or</div>\n\n      <div className={b(\"qr-code-container\")}>\n        <QRCodeSVG value={`${payment.address}?amount=${payment.displayAmount}`} />\n      </div>\n\n      <div className={b(\"payment-method-text\")}>\n        Scan following&nbsp;QR code with your wallet or&nbsp;enter Account&nbsp;ID&nbsp;and amount manually.\n      </div>\n\n      <a href=\"http://nearpay.co\" target=\"_blank\" rel=\"noopener noreferrer\" className={classNames(b(\"link-nearpay\"))}>\n        <span className={b(\"link-nearpay_gray\")}>Powered by</span>\n        {\"  \"}\n        <NpLogoIcon className={b(\"link-nearpay_icon\")} width=\"20\" height=\"15\" />\n        {\"  \"}\n        <span>NearPay</span>\n      </a>\n    </WidgetContainer>\n  );\n};\n","export const snakeToCamel = (str: string): string =>\n    str.toLowerCase().replace(/([-_][a-z])/g, group =>\n        group\n            .toUpperCase()\n            .replace('-', '')\n            .replace('_', '')\n    );\n","import { useMemo } from \"react\";\nimport { useParams } from \"react-router\";\nimport useSWR from \"swr\";\n\nimport { environment } from \"lib/config\";\nimport { ICurrency } from \"lib/api/currencies\";\nimport { currenciesApi, TPayment } from \"lib/api\";\nimport { nearToYoktoNear, useNear } from \"lib/near\";\nimport { usePayment } from \"models/payment\";\n\nexport const useModel = () => {\n  const { id: paymentId } = useParams();\n  const currenciesSwr = useSWR(\"currencies\", () => currenciesApi.fetchCurrencies(paymentId));\n  const { payment, isExpired, handleExpired } = usePayment();\n\n  const near = useNear();\n  const handlerPay = useHandlerPay({ near, payment: payment ?? null });\n\n  const defaultCurrency = useMemo(\n    () => currenciesSwr.data?.find((c) => c.ticker === environment.defaultCurrency),\n    [currenciesSwr]\n  );\n  const isLoaded = !!currenciesSwr.data && (!!payment || isExpired) && near.isReady;\n\n  return {\n    isExpired,\n    isLoaded,\n    payment: payment,\n    currencies: currenciesSwr.data,\n    defaultCurrency,\n    handlerPay,\n    handleExpired,\n  };\n};\n\nconst basePath = `${window.location.origin}/payment`;\n\ntype UsePayParams = {\n  near: ReturnType<typeof useNear>;\n  payment: TPayment | null;\n};\n\nconst useHandlerPay = (params: UsePayParams) => {\n  const { near, payment } = params;\n\n  if (!payment) {\n    return () => {\n      throw new Error(\"Payment is empty\");\n    };\n  }\n\n  if (!near.isAuthorized) {\n    return () =>\n      near.login({\n        successUrl: `${basePath}/${payment.paymentId}/send`,\n        failureUrl: `${basePath}/${payment.paymentId}/failure`,\n      });\n  }\n\n  return (currency: ICurrency) => {\n    switch (currency.ticker) {\n      case \"NEAR\":\n        const yoktoNearAmount = nearToYoktoNear(+payment.displayAmount);\n\n        if (!yoktoNearAmount || !payment.address) {\n          throw new Error(\"Data is empty\");\n        }\n\n        near.send(yoktoNearAmount, payment.address, `${basePath}/${payment.paymentId}/pending`);\n        break;\n\n      case \"USN\":\n        const usnUnits = +payment.displayAmountUsd * 1e18;\n\n        if (!usnUnits || !payment.address) {\n          throw new Error(\"Data is empty\");\n        }\n\n        near.ftTransfer(\"\" + usnUnits, \"usn\", payment.address, `${basePath}/${payment.paymentId}/pending`);\n        break;\n\n      default:\n        throw new Error(\"Unsupported currency\");\n    }\n  };\n};\n","import { block } from \"bem-cn\";\nimport useSenderWallet from \"lib/near/sender-wallet\";\nimport { environment } from \"lib/config\";\n\nimport { GeneralLayout, Loader, LoaderContainer } from \"ui\";\nimport { Agreement } from \"components/agreement\";\nimport { PayWidget } from \"components/pay-widget\";\nimport { useModel } from \"./model\";\nimport \"./payment-page.scss\";\n\nconst b = block(\"pay-with-near-payment-page\");\n\nexport function PaymentPage() {\n  const { defaultCurrency, payment, isLoaded, isExpired, handlerPay, handleExpired, currencies } = useModel();\n  const senderWallet = useSenderWallet();\n\n  if (!isLoaded) {\n    return (\n      <GeneralLayout>\n        <LoaderContainer>\n          <Loader />\n        </LoaderContainer>\n      </GeneralLayout>\n    );\n  }\n\n  if (isExpired) {\n    return (\n      <GeneralLayout className={b()}>\n        <span className={b(\"message\")}>This payment link is expired</span>\n        <a className={b(\"link\")} href={environment.payWithNearUrl}>\n          Back to shop\n        </a>\n      </GeneralLayout>\n    );\n  }\n\n  if (!payment || !defaultCurrency) {\n    return null;\n  }\n\n  return (\n    <GeneralLayout>\n      <PayWidget\n        payment={payment}\n        hasSenderWallet={senderWallet.isAvailable}\n        onSenderWallet={(cur) => senderWallet.pay(cur, payment)}\n        defaultCurrency={defaultCurrency}\n        currencies={currencies}\n        onExpired={handleExpired}\n        onPay={handlerPay}\n      />\n      <Agreement />\n    </GeneralLayout>\n  );\n}\n","import { PaymentPage } from \"./payment-page\";\nexport default PaymentPage;\n"],"names":["wallet","window","near","ftTransfer","amount","contractName","receiver","signAndSendTransaction","receiverId","actions","methodName","args","receiver_id","gas","DEFAULT_FUNCTION_CALL_GAS","deposit","assertResult","result","payment","response","error","toast","kind","ExecutionError","redirect","location","origin","paymentId","href","isAvailable","isSender","pay","currency","isSignedIn","requestSignIn","contractId","ticker","sendMoney","address","usnUnits","displayAmountUsd","toString","b","block","Agreement","props","className","mix","target","rel","proceedAppearance","disabled","loading","ProceedButton","forwardRef","ref","children","loadingText","withArrow","icon","rest","stateClassName","classNames","Input","label","slotAfterInput","slotRight","slotAfterLabel","size","textSize","placeholder","Error","inputClass","Icon","transform","transformProp","properties","Object","entries","property","value","push","join","buildTransform","style","width","height","CurrencySelect","options","onCurrencySelectClick","useState","isOpen","setOpen","toggleOpen","useCallback","prev","chooseOption","Boolean","navigator","userAgent","match","src","logoUrl","alt","viewedTicker","onChange","event","map","option","onClick","CurrencyInput","onInput","onValueChange","selectDisabled","inputDisabled","currencies","isLoading","prefix","symbol","readOnly","thousandSeparator","allowLeadingZeros","decimalScale","roundOff","WidgetContainer","ExpiryTimer","expiryAt","onExpired","getTimeLeft","timeLeft","setTimeLeft","useEffect","timer","setTimeout","clearTimeout","msecToTimeFormat","expiryAtDayjs","dayjs","curDayjs","diff","ms","minutes","Math","floor","minutesMs","seconds","bDescription","PayWidget","str","defaultCurrency","onPay","onSenderWallet","hasSenderWallet","setCurrency","changeCurrency","currentCurrency","find","item","name","description","parameter","toLowerCase","replace","group","toUpperCase","displayAmount","basePath","useHandlerPay","params","isAuthorized","yoktoNearAmount","nearToYoktoNear","send","login","successUrl","failureUrl","useParams","id","currenciesSwr","useSWR","currenciesApi","usePayment","isExpired","handleExpired","useNear","handlerPay","useMemo","data","c","environment","isLoaded","isReady","useModel","senderWallet","useSenderWallet","cur"],"sourceRoot":""}