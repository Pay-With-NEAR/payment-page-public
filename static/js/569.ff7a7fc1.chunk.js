"use strict";(self.webpackChunknearpay_donate=self.webpackChunknearpay_donate||[]).push([[569],{2589:function(e,n,r){r.r(n),r.d(n,{default:function(){return J}});var a=r(9824),t=r.n(a),i=r(8214),s=r(5861),c=r(8963),l=r(7891),o=function(){var e,n=window.near,r=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(r,a,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.signAndSendTransaction({receiverId:a,actions:[{methodName:"ft_transfer",args:{receiver_id:t,amount:r},gas:c.DEFAULT_FUNCTION_CALL_GAS,deposit:1}]}));case 1:case"end":return e.stop()}}),e)})));return function(n,r,a){return e.apply(this,arguments)}}(),a=function(e,n){if(e.response.error){var r,a;(0,l.A)(null!==(r=null===(a=e.response.error.kind)||void 0===a?void 0:a.ExecutionError)&&void 0!==r?r:"Contract error")}else{var t="".concat(window.location.origin,"/payment/").concat(n.payment_id,"/pending");window.location.href=t}};return{isAvailable:null!==(e=null===n||void 0===n?void 0:n.isSender)&&void 0!==e&&e,pay:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t,s){var c,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n&&!1!==n.isSender){e.next=2;break}return e.abrupt("return");case 2:if("near"===t.blockchain){e.next=5;break}return(0,l.A)("At the moment we only support near blockchain"),e.abrupt("return");case 5:if(!1!==n.isSignedIn()){e.next=8;break}return e.next=8,n.requestSignIn({contractId:"gopaywith.near"});case 8:e.t0=t.token,e.next="NEAR"===e.t0?11:16;break;case 11:return e.next=13,n.sendMoney({receiverId:t.address,amount:t.amount});case 13:return c=e.sent,a(c,s),e.abrupt("return");case 16:return e.next=18,r(t.amount,t.contract,t.address);case 18:return o=e.sent,a(o,s),e.abrupt("return");case 21:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()}},d=function(){var e,n=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0),n},u=function(){var e=function(e){return"NEAR"===e.token&&d()};return{isAvailable:e,pay:function(){var n=(0,s.Z)((0,i.Z)().mark((function n(r){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!1!==e(r)){n.next=3;break}return(0,l.A)("Trust Wallet is not support for current platform or currency"),n.abrupt("return");case 3:"c397","https://link.trustwallet.com/send",window.location.href="".concat("https://link.trustwallet.com/send","?asset=").concat("c397","&address=").concat(r.address,"&amount=").concat(r.displayAmount);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},p=r(8767),m=r(4443),h=r(184),v=t()("pay-with-near-agreement"),f=function(e){var n=e.className;return(0,h.jsxs)("div",{className:v.mix(n),children:["By continuing, you agree to this"," ",(0,h.jsx)("a",{href:"https://linkee.ws/privacy-policy",target:"_blank",rel:"noopener noreferrer",children:"privacy policy"})," ","and"," ",(0,h.jsx)("a",{href:"https://linkee.ws/terms-and-conditions",target:"_blank",rel:"noopener noreferrer",children:"terms of service"})]})},x=r(885),y=r(1694),b=r.n(y),j=r(2791),k=r(6009),g=r(8683),w=r(4925),N=["disabled","children","loading","className","withArrow","loadingText","icon"];function _(e){var n=e.disabled,r=e.loading;return n?"ProceedButton--disabled":r?"ProceedButton--loading":"ProceedButton--active"}var C=(0,j.forwardRef)((function(e,n){var r=e.disabled,a=void 0!==r&&r,t=e.children,i=e.loading,s=void 0!==i&&i,c=e.className,l=(e.withArrow,e.loadingText),o=e.icon,d=(0,w.Z)(e,N),u=_({disabled:a,loading:s});return(0,h.jsxs)("button",(0,g.Z)((0,g.Z)({ref:n,className:b()("ProceedButton",u,c),disabled:a},d),{},{children:[s&&l?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{}),(0,h.jsx)("span",{children:l}),(0,h.jsx)("span",{})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{}),(0,h.jsx)("span",{children:t}),(0,h.jsx)("span",{})]}),o&&(0,h.jsx)("div",{className:"ProceedButton__icon",children:o})]}))})),S=["label","slotAfterInput","slotRight","slotAfterLabel","children","error","size","textSize","className","placeholder"];function Z(e){var n=e.label,r=e.slotAfterInput,a=e.slotRight,t=e.slotAfterLabel,i=e.children,s=e.error,c=(e.size,e.textSize,e.className),l=(e.placeholder,(0,w.Z)(e,S));if(r&&a)throw Error("Only one of after input slots can be used");return(0,h.jsxs)("label",(0,g.Z)((0,g.Z)({className:b()("Input",s?"Input--hasError":"",c)},l),{},{children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsxs)("div",{className:"flex-grow",children:[(0,h.jsxs)("div",{className:"Input__header",children:[(0,h.jsx)("div",{className:"Input__label",children:n}),t]}),(0,h.jsxs)("div",{className:"Input__wrapper",children:["function"===typeof i?i({inputClass:"Input__input"}):i,r?(0,h.jsx)("div",{className:"Input__after",children:r}):null]})]}),a?(0,h.jsx)("div",{className:"Input__afterCentered",children:a}):null]}),s?(0,h.jsx)("div",{className:"Input__error",children:s}):null]}))}var A=r(948),I=["icon","className","transform","size","children"];function z(e){e.icon;var n=e.className,r=e.transform,a=e.size,t=e.children,i=(0,w.Z)(e,I),s=function(e){if(!e)return"";for(var n=[],r=0,a=Object.entries(e);r<a.length;r++){var t=(0,x.Z)(a[r],2),i=t[0],s=t[1];n.push("".concat(i,"(").concat(s,")"))}return n.join(",")}(r||{});return(0,h.jsx)("i",(0,g.Z)((0,g.Z)({className:b()("pay-with-near-icon",n),style:{transform:s,width:a,height:a}},i),{},{children:t}))}var E=["currency","options","className","disabled","onCurrencySelectClick"];function T(e){var n=e.currency,r=e.options,a=e.className,t=e.disabled,i=e.onCurrencySelectClick,s=(0,w.Z)(e,E),c=(0,j.useState)(!1),l=(0,x.Z)(c,2),o=l[0],u=l[1],p=(0,j.useCallback)((function(){u((function(e){return!e}))}),[]),v=(0,j.useCallback)((function(e){p(),i(e)}),[p,i]);return(0,h.jsx)("div",(0,g.Z)((0,g.Z)({className:b()("CurrencySelect",t?"CurrencySelect--disabled":"",a)},s),{},{children:d()?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(z,{className:"CurrencySelect__icon",children:(0,h.jsx)("img",{src:n.icon,alt:n.token})}),(0,h.jsx)("select",{className:"CurrencySelect__select",onChange:function(e){return i(e.target.value)},children:null===r||void 0===r?void 0:r.map((function(e){return(0,h.jsx)("option",{value:e.token,children:e.token},e.token)}))})]}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"CurrencySelect__container",children:[(0,h.jsxs)("button",{className:"CurrencySelect__button",onClick:p,children:[(0,h.jsx)(z,{className:"CurrencySelect__icon",children:(0,h.jsx)("img",{src:n.icon,alt:n.token})}),(0,h.jsx)("div",{className:"CurrencySelect__text",children:n.token}),(0,h.jsx)(z,{size:20,className:"CurrencySelect__arrow",children:(0,h.jsx)(m.UL,{})})]}),o&&(0,h.jsx)("ul",{className:"CurrencySelect__list",children:null===r||void 0===r?void 0:r.map((function(e){return(0,h.jsxs)("li",{className:"CurrencySelect__item",onClick:function(){return v(e.token)},children:[(0,h.jsx)(z,{className:"CurrencySelect__icon",children:(0,h.jsx)("img",{src:e.icon,alt:e.token})}),e.token]},e.icon)}))})]})})}))}var W=["onInput","value","label","onValueChange","onCurrencySelectClick","error","selectDisabled","inputDisabled","currency","currencies","isLoading"];function P(e){var n=e.onInput,r=e.value,a=e.label,t=e.onValueChange,i=e.onCurrencySelectClick,s=e.error,c=e.selectDisabled,l=(e.inputDisabled,e.currency),o=e.currencies,d=e.isLoading,u=void 0!==d&&d,p=(0,w.Z)(e,W);return(0,h.jsx)(Z,(0,g.Z)((0,g.Z)({label:a,error:s,slotAfterInput:(0,h.jsx)(T,{currency:l,onCurrencySelectClick:c?function(){}:i,disabled:!!c,options:o})},p),{},{children:u?(0,h.jsx)("input",{disabled:!0,readOnly:!0}):(0,h.jsx)(A.Z,{thousandSeparator:!1,onValueChange:t,allowLeadingZeros:!0,onInput:n,value:r,placeholder:"0.00",readOnly:!0})}))}var R=r(7892),L=r.n(R),q=(0,a.block)("pay-with-near-pay-timer"),B=function(e){var n=e.expiryAt,r=e.onExpired,a=(0,j.useState)(D(n)),t=(0,x.Z)(a,2),i=t[0],s=t[1];return(0,j.useEffect)((function(){D(n)<0&&r();var e=setTimeout((function(){s(D(n))}),1e3);return function(){return clearTimeout(e)}}),[i,n,r]),D(n)<0?null:(0,h.jsx)("div",{className:q(),children:F(i)})},D=function(e){var n=L()(e),r=L().utc();return n.diff(r)},F=function(e){var n=Math.floor(e/6e4),r=e%6e4,a=Math.floor(r/1e3);return"".concat(n,":").concat(a>9?a:"0".concat(a))},O=["className"];function V(e){var n=e.className,r=(0,w.Z)(e,O);return(0,h.jsx)("div",(0,g.Z)({className:b()("WidgetContainer",n)},r))}var U=(0,a.block)("pay-with-near-pay-widget"),M=(0,a.block)("pay-with-near-pay-widget-description"),X=function(e){var n=e.payment,r=e.onNearWallet,a=e.onExpired,t=e.onSenderWallet,i=e.hasSenderWallet,s=e.hasTrustWallet,c=e.onTrustWallet,l=(0,j.useState)([]),o=(0,x.Z)(l,2),d=o[0],u=o[1],p=(0,j.useState)((function(){return n.addresses[0]})),v=(0,x.Z)(p,2),f=v[0],y=v[1];(0,j.useEffect)((function(){var e=n.addresses.filter((function(e){return!1===n.hide_usn||"usn"!==e.token.toLowerCase()}));u(e),y(e[0])}),[n]);var g="$".concat(n.display_amount_usd);"eur"===n.local_currency&&(g="\u20ac".concat(n.display_amount_eur));var w=(0,j.useCallback)((function(e){var n=d.find((function(n){return n.token===e}));y(null!==n&&void 0!==n?n:d[0])}),[d]);return(0,h.jsxs)(V,{className:U(),children:[(0,h.jsx)("div",{className:U("title"),children:n.name}),(0,h.jsx)("div",{className:U("description"),children:n.description}),(0,h.jsxs)("div",{className:M(),children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:M("label"),children:"Payment: "}),(0,h.jsx)("div",{children:n.payment_id})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:M("label"),children:"Recipient: "}),(0,h.jsx)("div",{className:M("address"),children:f.address})]})]}),(0,h.jsxs)("div",{className:U("flexbox"),children:[(0,h.jsx)("div",{className:U("amount"),children:g}),(0,h.jsx)(B,{expiryAt:n.expiry_at,onExpired:a})]}),(0,h.jsx)(P,{label:"Amount to Pay",value:f.displayAmount,currency:f,onValueChange:function(){},onCurrencySelectClick:w,selectDisabled:!1,currencies:d,className:"mb-4"}),(0,h.jsx)(C,{onClick:function(){return r(f)},children:"Pay with NEAR wallet"}),i&&(0,h.jsx)(C,{onClick:function(){return t(f)},children:"Pay with Sender Wallet"}),s(f)&&(0,h.jsx)(C,{onClick:function(){return c(f)},children:"Pay with Trust Wallet"}),(0,h.jsx)("div",{className:U("or"),children:"or"}),(0,h.jsx)("div",{className:U("qr-code-container"),children:(0,h.jsx)(k.tv,{value:"".concat(f.address,"?amount=").concat(f.displayAmount)})}),(0,h.jsx)("div",{className:U("payment-method-text"),children:"Scan following\xa0QR code with your wallet or\xa0enter Account\xa0ID\xa0and amount manually."}),(0,h.jsxs)("a",{href:"http://nearpay.co",target:"_blank",rel:"noopener noreferrer",className:b()(U("link-nearpay")),children:[(0,h.jsx)("span",{className:U("link-nearpay_gray"),children:"Powered by"}),"  ",(0,h.jsx)(m.v5,{className:U("link-nearpay_icon"),width:"20",height:"15"}),"  ",(0,h.jsx)("span",{children:"NearPay"})]})]})},G=r(9215),Q=r(4967),$=r(4233),H=(0,a.block)("pay-with-near-payment-page");var J=function(){var e=(0,Q.T)(),n=(0,$.V)(),r=n.payment,a=n.isExpired,t=n.handleExpired,i=(0,G.g)({near:e,payment:null!==r&&void 0!==r?r:null}),s=o(),c=u(),l=(!!r||a)&&e.isReady,d=(null===r||void 0===r?void 0:r.return_url)||document.referrer||p.N.payWithNearUrl;return l?a?(0,h.jsxs)(m.RX,{className:H(),children:[(0,h.jsx)("span",{className:H("message"),children:"This payment link is expired"}),document.referrer&&(0,h.jsx)("a",{className:H("link"),href:d,children:"Back to shop"})]}):r?(0,h.jsxs)(m.RX,{children:[(0,h.jsx)(X,{payment:r,hasTrustWallet:c.isAvailable,hasSenderWallet:s.isAvailable,onTrustWallet:function(e){return c.pay(e)},onSenderWallet:function(e){return s.pay(e,r)},onNearWallet:function(e){return i(e)},onExpired:t}),(0,h.jsx)(f,{})]}):null:(0,h.jsx)(m.RX,{children:(0,h.jsx)(m.zL,{children:(0,h.jsx)(m.aN,{})})})}}}]);
//# sourceMappingURL=569.ff7a7fc1.chunk.js.map